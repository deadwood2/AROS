
include $(SRCDIR)/config/aros.cfg
include $(SRCDIR)/workbench/libs/mesa/mesa.cfg

GALLIUM_PATH = $(SRCDIR)/workbench/libs/mesa7/src/gallium

#MM- workbench-hidds-vmwaresvga : hidd-vmwaresvga
#MM- hidd-vmwaresvga: includes hidd-gallium mesa3dgl-linklibs linklibs-libatomic workbench-libs-z-linklib

MESA3D_VMWARESVGA_C_SOURCES := $(filter %.c,$(C_SOURCES))

GALLIUMFILES	:=	\
	vmwaresvga_galliumclass \
	vmwaresvga_gallium_screen \
	vmwaresvga_gallium_surf \
	vmwaresvga_gallium_ctx \
	arosc_emul \
	$(addprefix $(GALLIUM_PATH)/drivers/svga/,$(MESA3D_VMWARESVGA_C_SOURCES:.c=))

FILES	:=	\
	vmwaresvga_init \
	vmwaresvga_hiddclass \
	vmwaresvga_hardware \
	vmwaresvga_offbitmapclass \
	vmwaresvga_onbitmapclass


# disable necessary warnings
NOWARN_FLAGS := $(NOWARN_UNUSED_VALUE) $(NOWARN_UNUSED_VARIABLE) $(NOWARN_STRICT_ALIASING)
USER_CFLAGS += $(NOWARN_FLAGS)

USER_INCLUDES += \
            -iquote $(GALLIUM_PATH)/drivers/svga/include \
            -iquote $(GALLIUM_PATH)/drivers/svga \
            -iquote $(GALLIUM_PATH)/drivers \
            -iquote $(GALLIUM_PATH)/include \
            -iquote $(GALLIUM_PATH)/auxiliary \
            -iquote $(GENDIR)/workbench/libs/mesa/src/mesa/main \
            -I $(GALLIUM_PATH)/include \

USER_CPPFLAGS += \
                -DPACKAGE_VERSION=\"$(MESAGLVERSION)\"
#USER_CPPFLAGS += -DDEBUG=1

USER_LDFLAGS := \
  -lgalliumauxiliary \
  -lz -lpthread

%build_module mmake=hidd-vmwaresvga \
  modname=vmwaresvga modtype=hidd \
  files=$(FILES) \
  uselibs="oop" usesdks="private mesa"

%common
